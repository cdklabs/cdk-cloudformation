{
  "Arn": "arn:aws:cloudformation:us-east-1::type/resource/4f06bc39af5f4b984dd46ad17f10316e6258d9fa/Aqua-Enterprise-Enforcer",
  "Type": "RESOURCE",
  "TypeName": "Aqua::Enterprise::Enforcer",
  "Description": "A resource provider for Aqua Enterprise Enforcer.",
  "Schema": "{\n    \"typeName\": \"Aqua::Enterprise::Enforcer\",\n    \"description\": \"A resource provider for Aqua Enterprise Enforcer.\",\n    \"sourceUrl\": \"https://github.com/aquasecurity/aqua-helm.git\",\n    \"definitions\": {\n        \"Arn\": {\n            \"type\": \"string\",\n            \"pattern\": \"^arn:aws(-(cn|us-gov))?:[a-z-]+:(([a-z]+-)+[0-9])?:([0-9]{12})?:[^.]+$\"\n        }\n    },\n    \"properties\": {\n        \"ClusterID\": {\n            \"description\": \"EKS cluster name\",\n            \"type\": \"string\"\n        },\n        \"KubeConfig\": {\n            \"description\": \"Secrets Manager ARN for kubeconfig file\",\n            \"$ref\": \"#/definitions/Arn\"\n        },\n        \"RoleArn\": {\n            \"description\": \"IAM to use with EKS cluster authentication, if not resource execution role will be used\",\n            \"$ref\": \"#/definitions/Arn\"\n        },\n        \"Namespace\": {\n            \"description\": \"Namespace to use with helm. Created if doesn't exist and default will be used if not provided\",\n            \"type\": \"string\"\n        },\n        \"Name\": {\n            \"description\": \"Name for the helm release\",\n            \"type\": \"string\"\n        },\n        \"Values\": {\n            \"description\": \"Custom Values can optionally be specified\",\n            \"type\": \"object\",\n            \"additionalProperties\": false,\n            \"patternProperties\": {\n                \"^.+$\": {\"type\": \"string\"}\n            }\n        },\n        \"ValueYaml\": {\n            \"description\": \"String representation of a values.yaml file\",\n            \"type\": \"string\"\n        },\n        \"Version\": {\n            \"description\": \"Version can be specified, if not latest will be used\",\n            \"type\": \"string\"\n        },\n        \"ValueOverrideURL\": {\n            \"description\": \"Custom Value Yaml file can optionally be specified\",\n            \"type\": \"string\",\n            \"pattern\": \"^[sS]3://[0-9a-zA-Z]([-.\\\\w]*[0-9a-zA-Z])(:[0-9]*)*([?/#].*)?$\"\n        },\n        \"ID\": {\n            \"description\": \"Primary identifier for Cloudformation\",\n            \"type\": \"string\"\n        },\n        \"TimeOut\": {\n            \"description\": \"Timeout for resource provider. Default 60 mins\",\n            \"type\": \"integer\"\n        },\n        \"VPCConfiguration\": {\n            \"type\": \"object\",\n            \"description\": \"For network connectivity to Cluster inside VPC\",\n            \"additionalProperties\": false,\n            \"properties\": {\n                \"SecurityGroupIds\": {\n                    \"description\": \"Specify one or more security groups\",\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                    }\n                },\n                \"SubnetIds\": {\n                    \"description\": \"Specify one or more subnets\",\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                    }\n                }\n            }\n        }\n    },\n    \"additionalProperties\": false,\n    \"readOnlyProperties\": [\n        \"/properties/Resources\",\n        \"/properties/ID\"\n    ],\n    \"primaryIdentifier\": [\n        \"/properties/ID\"\n    ],\n    \"createOnlyProperties\": [\n        \"/properties/Name\",\n        \"/properties/Namespace\",\n        \"/properties/ClusterID\"\n    ],\n    \"handlers\": {\n        \"create\": {\n            \"permissions\": [\n                \"secretsmanager:GetSecretValue\",\n                \"kms:Decrypt\",\n                \"eks:DescribeCluster\",\n                \"s3:GetObject\",\n                \"sts:AssumeRole\",\n                \"iam:PassRole\",\n                \"ec2:CreateNetworkInterface\",\n                \"ec2:DescribeNetworkInterfaces\",\n                \"ec2:DeleteNetworkInterface\",\n                \"ec2:DescribeVpcs\",\n                \"ec2:DescribeSubnets\",\n                \"ec2:DescribeRouteTables\",\n                \"ec2:DescribeSecurityGroups\",\n                \"logs:CreateLogGroup\",\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\",\n                \"lambda:UpdateFunctionConfiguration\",\n                \"lambda:DeleteFunction\",\n                \"lambda:GetFunction\",\n                \"lambda:InvokeFunction\",\n                \"lambda:CreateFunction\",\n                \"lambda:UpdateFunctionCode\"\n            ]\n        },\n        \"read\": {\n            \"permissions\": [\n                \"secretsmanager:GetSecretValue\",\n                \"kms:Decrypt\",\n                \"eks:DescribeCluster\",\n                \"s3:GetObject\",\n                \"sts:AssumeRole\",\n                \"iam:PassRole\",\n                \"ec2:CreateNetworkInterface\",\n                \"ec2:DescribeNetworkInterfaces\",\n                \"ec2:DeleteNetworkInterface\",\n                \"ec2:DescribeVpcs\",\n                \"ec2:DescribeSubnets\",\n                \"ec2:DescribeRouteTables\",\n                \"ec2:DescribeSecurityGroups\",\n                \"logs:CreateLogGroup\",\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\",\n                \"lambda:UpdateFunctionConfiguration\",\n                \"lambda:DeleteFunction\",\n                \"lambda:GetFunction\",\n                \"lambda:InvokeFunction\",\n                \"lambda:CreateFunction\",\n                \"lambda:UpdateFunctionCode\"\n            ]\n        },\n        \"update\": {\n            \"permissions\": [\n                \"secretsmanager:GetSecretValue\",\n                \"kms:Decrypt\",\n                \"eks:DescribeCluster\",\n                \"s3:GetObject\",\n                \"sts:AssumeRole\",\n                \"iam:PassRole\",\n                \"ec2:CreateNetworkInterface\",\n                \"ec2:DescribeNetworkInterfaces\",\n                \"ec2:DeleteNetworkInterface\",\n                \"ec2:DescribeVpcs\",\n                \"ec2:DescribeSubnets\",\n                \"ec2:DescribeRouteTables\",\n                \"ec2:DescribeSecurityGroups\",\n                \"logs:CreateLogGroup\",\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\",\n                \"lambda:UpdateFunctionConfiguration\",\n                \"lambda:DeleteFunction\",\n                \"lambda:GetFunction\",\n                \"lambda:InvokeFunction\",\n                \"lambda:CreateFunction\",\n                \"lambda:UpdateFunctionCode\"\n            ]\n        },\n        \"delete\": {\n            \"permissions\": [\n                \"secretsmanager:GetSecretValue\",\n                \"kms:Decrypt\",\n                \"eks:DescribeCluster\",\n                \"s3:GetObject\",\n                \"sts:AssumeRole\",\n                \"iam:PassRole\",\n                \"ec2:CreateNetworkInterface\",\n                \"ec2:DescribeNetworkInterfaces\",\n                \"ec2:DeleteNetworkInterface\",\n                \"ec2:DescribeVpcs\",\n                \"ec2:DescribeSubnets\",\n                \"ec2:DescribeRouteTables\",\n                \"ec2:DescribeSecurityGroups\",\n                \"logs:CreateLogGroup\",\n                \"logs:CreateLogStream\",\n                \"logs:PutLogEvents\",\n                \"lambda:UpdateFunctionConfiguration\",\n                \"lambda:DeleteFunction\",\n                \"lambda:GetFunction\",\n                \"lambda:InvokeFunction\",\n                \"lambda:CreateFunction\",\n                \"lambda:UpdateFunctionCode\"\n            ]\n        }\n    }\n}\n",
  "ProvisioningType": "FULLY_MUTABLE",
  "DeprecatedStatus": "LIVE",
  "RequiredActivatedTypes": [],
  "Visibility": "PUBLIC",
  "SourceUrl": "https://github.com/aquasecurity/aqua-helm.git",
  "TimeCreated": "2021-06-17T21:53:52.012Z",
  "PublisherId": "4f06bc39af5f4b984dd46ad17f10316e6258d9fa",
  "LatestPublicVersion": "1.6.0",
  "IsActivated": false
}